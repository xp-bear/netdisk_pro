# 个人资料页面功能说明

## 功能概述
实现了完整的用户个人资料管理页面，允许用户查看和修改个人信息、修改密码、管理账号等。

## 实现的功能

### 1. 基本信息展示
- **用户头像**：显示用户头像，支持更换（通过URL）
- **用户信息**：显示用户名、昵称、用户ID
- **存储空间**：显示已用空间/总空间，带进度条可视化
  - 使用率 < 60%：绿色
  - 使用率 60-80%：黄色
  - 使用率 > 80%：红色

### 2. 基本信息管理（Tab：基本信息）
- **查看信息**：
  - 用户名（只读）
  - 昵称（可编辑）
  - 邮箱（可编辑）
  - 注册时间（只读）

- **编辑功能**：
  - 点击"编辑资料"按钮进入编辑模式
  - 可修改昵称和邮箱
  - 保存或取消修改
  - 修改后实时更新用户状态

### 3. 头像管理
- 点击"更换头像"按钮打开对话框
- **两种方式**：
  - **上传头像（推荐）**：
    - 支持点击或拖拽上传
    - 支持 jpg、png、gif 格式
    - 文件大小限制 2MB
    - 实时预览效果
    - 显示上传进度
    - 图片自动上传到阿里云OSS
  - **输入URL**：
    - 输入头像URL地址
    - 实时预览头像效果
- 确认更新后立即生效

### 4. 安全设置（Tab：安全设置）
- **修改密码**：
  - 输入旧密码验证身份
  - 输入新密码（至少6个字符）
  - 确认新密码（两次输入必须一致）
  - 表单验证确保输入合法
  - 修改成功后自动退出登录

### 5. 账号管理（Tab：账号管理）
- **退出登录**：
  - 点击退出按钮弹出确认对话框
  - 确认后清除用户状态并跳转到登录页

## 技术实现

### 前端文件
- **`views/Profile.vue`**：个人资料页面主组件
  - 使用 Element Plus UI 组件库
  - 响应式布局，支持移动端
  - 美观的渐变背景和卡片设计
  - 集成阿里云OSS文件上传

### OSS 配置
- **`utils/oss.js`**：OSS上传工具
  - 头像上传到 `avatars/{userId}/` 目录
  - 支持上传进度回调
  - 自动返回CDN访问地址

### 路由配置
- **路径**：`/profile`
- **路由名称**：`Profile`
- **访问控制**：需要登录（`requiresAuth: true`）

### 状态管理
- 使用 `useUserStore` 管理用户状态
- 支持实时更新用户信息
- 本地存储持久化

### API 接口（已有）
- `GET /api/auth/user`：获取用户信息
- `PUT /api/auth/user`：更新用户信息（昵称、邮箱、头像）
- `PUT /api/auth/password`：修改密码

## 页面访问方式

### 1. 从主页访问
在主页顶部导航栏，点击用户头像 → 下拉菜单 → "个人资料"

### 2. 直接访问
在浏览器地址栏输入：`http://localhost:3000/profile`（需要先登录）

### 3. 返回主页
点击页面左上角的"返回"按钮

## 页面布局

```
┌─────────────────────────────────────────┐
│ ← 返回                                    │
│ ┌─────────────────────────────────────┐ │
│ │  [头像]    用户昵称                    │ │
│ │            @用户名                     │ │
│ │            [ID: xxx]                  │ │
│ ├─────────────────────────────────────┤ │
│ │  存储空间                              │ │
│ │  [进度条] 已用 / 总空间                │ │
│ ├─────────────────────────────────────┤ │
│ │  [基本信息] [安全设置] [账号管理]      │ │
│ │  ┌───────────────────────────────┐   │ │
│ │  │  Tab 内容区域                   │   │ │
│ │  │  - 表单/操作按钮                │   │ │
│ │  └───────────────────────────────┘   │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

## 表单验证规则

### 头像上传
- **文件类型**：仅支持图片格式（image/*）
- **文件大小**：不超过 5MB
- **推荐尺寸**：200x200 像素

### 昵称
- 可选字段，留空时不更新

### 邮箱
- 可选字段，留空时不更新
- 需要符合邮箱格式（前端通过 Element Plus 验证）

### 密码修改
- **旧密码**：必填
- **新密码**：
  - 必填
  - 最少6个字符
- **确认密码**：
  - 必填
  - 必须与新密码一致

## 用户体验优化

1. **加载状态**：所有异步操作都有 loading 状态显示
2. **错误提示**：操作失败时显示友好的错误消息
3. **成功反馈**：操作成功时显示成功提示
4. **确认对话框**：退出登录等重要操作需要二次确认
5. **响应式设计**：支持不同屏幕尺寸，移动端友好
6. **渐变背景**：美观的紫色渐变背景
7. **实时更新**：修改信息后立即更新页面显示
8. **拖拽上传**：支持拖拽图片上传头像
9. **上传进度**：实时显示上传进度条
10. **图片预览**：上传前可预览头像效果

## 安全性

1. **密码验证**：修改密码需要验证旧密码
2. **登录状态**：未登录用户无法访问个人资料页面
3. **token 认证**：所有 API 请求都携带 token
4. **user_id 隔离**：只能查看和修改自己的信息

## 注意事项

1. ~~头像功能目前支持通过 URL 设置，可以后续扩展为上传图片~~（已实现）
2. **头像上传**：支持本地上传图片，自动上传到阿里云OSS
3. 修改密码后会自动退出登录，需要使用新密码重新登录
4. 邮箱格式验证在后端实现，前端可添加额外验证
5. 用户名一旦注册不可修改（数据库设计决定）
6. 头像文件大小限制为 5MB，超过会提示错误

## 后续优化建议

1. ~~**头像上传**：支持本地上传头像图片~~（已实现✅）
2. **头像裁剪**：上传前支持裁剪和调整图片
3. **邮箱验证**：发送验证邮件确认邮箱真实性
4. **找回密码**：通过邮箱重置密码功能
5. **账号注销**：提供账号注销功能
6. **登录历史**：显示最近登录记录
7. **安全设置**：两步验证、设备管理等
8. **个性化设置**：主题、语言等偏好设置
9. **头像模板**：提供默认头像选择
10. **图片压缩**：上传前自动压缩大图片
